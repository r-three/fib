

BLOOM_DEVICE_MAP = {'transformer.word_embeddings': 0,
                    'transformer.word_embeddings_layernorm': 0,
                    'transformer.h.0': 0,
                    'transformer.h.1': 0,
                    'transformer.h.2': 0,
                    'transformer.h.3': 0,
                    'transformer.h.4': 0,
                    'transformer.h.5': 0,
                    'transformer.h.6': 0,
                    'transformer.h.7': 0,
                    'transformer.h.8': 0,
                    'transformer.h.9': 0,
                    'transformer.h.10': 0,
                    'transformer.h.11': 0,
                    'transformer.h.12': 0,
                    'transformer.h.13': 0,
                    'transformer.h.14': 0,
                    'transformer.h.15': 0,
                    'transformer.h.16': 1,
                    'transformer.h.17': 1,
                    'transformer.h.18': 1,
                    'transformer.h.19': 1,
                    'transformer.h.20': 1,
                    'transformer.h.21': 1,
                    'transformer.h.22': 1,
                    'transformer.h.23': 1,
                    'transformer.h.24': 1,
                    'transformer.h.25': 1,
                    'transformer.h.26': 1,
                    'transformer.h.27': 1,
                    'transformer.h.28': 1,
                    'transformer.h.29': 1,
                    'transformer.h.30': 1,
                    'transformer.h.31': 1,
                    'transformer.h.32': 1,
                    'transformer.h.33': 1,
                    'transformer.h.34': 1,
                    'transformer.h.35': 2,
                    'transformer.h.36': 2,
                    'transformer.h.37': 2,
                    'transformer.h.38': 2,
                    'transformer.h.39': 2,
                    'transformer.h.40': 2,
                    'transformer.h.41': 2,
                    'transformer.h.42': 2,
                    'transformer.h.43': 2,
                    'transformer.h.44': 2,
                    'transformer.h.45': 2,
                    'transformer.h.46': 2,
                    'transformer.h.47': 2,
                    'transformer.h.48': 2,
                    'transformer.h.49': 2,
                    'transformer.h.50': 2,
                    'transformer.h.51': 2,
                    'transformer.h.52': 2,
                    'transformer.h.53': 3,
                    'transformer.h.54': 3,
                    'transformer.h.55': 3,
                    'transformer.h.56': 3,
                    'transformer.h.57': 3,
                    'transformer.h.58': 3,
                    'transformer.h.59': 3,
                    'transformer.h.60': 3,
                    'transformer.h.61': 3,
                    'transformer.h.62': 3,
                    'transformer.h.63': 3,
                    'transformer.h.64': 3,
                    'transformer.h.65': 3,
                    'transformer.h.66': 3,
                    'transformer.h.67': 3,
                    'transformer.h.68': 3,
                    'transformer.h.69': 3,
                    'transformer.ln_f': 0,
                    'lm_head': 0,
                    }

GPT_NEOX_DEVICE_MAP = {'gpt_neox.embed_in': 0,
                       'gpt_neox.layers.0': 0,
                       'gpt_neox.layers.1': 0,
                       'gpt_neox.layers.2': 0,
                       'gpt_neox.layers.3': 0,
                       'gpt_neox.layers.4': 0,
                       'gpt_neox.layers.5': 0,
                       'gpt_neox.layers.6': 0,
                       'gpt_neox.layers.7': 0,
                       'gpt_neox.layers.8': 0,
                       'gpt_neox.layers.9': 0,
                       'gpt_neox.layers.10': 0,
                       'gpt_neox.layers.11': 0,
                       'gpt_neox.layers.12': 0,
                       'gpt_neox.layers.13': 0,
                       'gpt_neox.layers.14': 0,
                       'gpt_neox.layers.15': 0,
                       'gpt_neox.layers.16': 0,
                       'gpt_neox.layers.17': 0,
                       'gpt_neox.layers.18': 0,
                       'gpt_neox.layers.19': 0,
                       'gpt_neox.layers.20': 0,
                       'gpt_neox.layers.21': 0,
                       'gpt_neox.layers.22': 1,
                       'gpt_neox.layers.23': 1,
                       'gpt_neox.layers.24': 1,
                       'gpt_neox.layers.25': 1,
                       'gpt_neox.layers.26': 1,
                       'gpt_neox.layers.27': 1,
                       'gpt_neox.layers.28': 1,
                       'gpt_neox.layers.29': 1,
                       'gpt_neox.layers.30': 1,
                       'gpt_neox.layers.31': 1,
                       'gpt_neox.layers.32': 1,
                       'gpt_neox.layers.33': 1,
                       'gpt_neox.layers.34': 1,
                       'gpt_neox.layers.35': 1,
                       'gpt_neox.layers.36': 1,
                       'gpt_neox.layers.37': 1,
                       'gpt_neox.layers.38': 1,
                       'gpt_neox.layers.39': 1,
                       'gpt_neox.layers.40': 1,
                       'gpt_neox.layers.41': 1,
                       'gpt_neox.layers.42': 1,
                       'gpt_neox.layers.43': 1,
                       'gpt_neox.final_layer_norm': 1,
                       'embed_out': 0
                       }

T0_DEVICE_MAP = {
    'shared': 0,
    'decoder.embed_tokens': 0,
    'encoder': 0,
    'decoder.block.0': 0,
    'decoder.block.1': 0,
    'decoder.block.2': 0,
    'decoder.block.3': 1,
    'decoder.block.4': 1,
    'decoder.block.5': 1,
    'decoder.block.6': 1,
    'decoder.block.7': 1,
    'decoder.block.8': 1,
    'decoder.block.9': 1,
    'decoder.block.10': 1,
    'decoder.block.11': 1,
    'decoder.block.12': 1,
    'decoder.block.13': 1,
    'decoder.block.14': 1,
    'decoder.block.15': 1,
    'decoder.block.16': 1,
    'decoder.block.17': 1,
    'decoder.block.18': 1,
    'decoder.block.19': 1,
    'decoder.block.20': 1,
    'decoder.block.21': 1,
    'decoder.block.22': 1,
    'decoder.block.23': 1,
    'decoder.final_layer_norm': 1,
    'decoder.dropout': 1,
    'lm_head': 0
}

OPT_66B_DEVICE_MAP = {
    'model.decoder.embed_tokens': 0,
    'lm_head': 0,
    'model.decoder.embed_positions': 0,
    'model.decoder.final_layer_norm': 0,
    'model.decoder.layers.0': 0,
    'model.decoder.layers.1': 0,
    'model.decoder.layers.2': 0,
    'model.decoder.layers.3': 0,
    'model.decoder.layers.4': 0,
    'model.decoder.layers.5': 0,
    'model.decoder.layers.6': 0,
    'model.decoder.layers.7': 0,
    'model.decoder.layers.8': 0,
    'model.decoder.layers.9': 0,
    'model.decoder.layers.10': 0,
    'model.decoder.layers.11': 0,
    'model.decoder.layers.12': 0,
    'model.decoder.layers.13': 0,
    'model.decoder.layers.14': 0,
    'model.decoder.layers.15': 0,
    'model.decoder.layers.16': 0,
    'model.decoder.layers.17': 0,
    'model.decoder.layers.18': 0,
    'model.decoder.layers.19': 0,
    'model.decoder.layers.20': 0,
    'model.decoder.layers.21': 1,
    'model.decoder.layers.22': 1,
    'model.decoder.layers.23': 1,
    'model.decoder.layers.24': 1,
    'model.decoder.layers.25': 1,
    'model.decoder.layers.26': 1,
    'model.decoder.layers.27': 1,
    'model.decoder.layers.28': 1,
    'model.decoder.layers.29': 1,
    'model.decoder.layers.30': 1,
    'model.decoder.layers.31': 1,
    'model.decoder.layers.32': 1,
    'model.decoder.layers.33': 1,
    'model.decoder.layers.34': 1,
    'model.decoder.layers.35': 1,
    'model.decoder.layers.36': 1,
    'model.decoder.layers.37': 1,
    'model.decoder.layers.38': 1,
    'model.decoder.layers.39': 1,
    'model.decoder.layers.40': 1,
    'model.decoder.layers.41': 1,
    'model.decoder.layers.42': 2,
    'model.decoder.layers.43': 2,
    'model.decoder.layers.44': 2,
    'model.decoder.layers.45': 2,
    'model.decoder.layers.46': 2,
    'model.decoder.layers.47': 2,
    'model.decoder.layers.48': 2,
    'model.decoder.layers.49': 2,
    'model.decoder.layers.50': 2,
    'model.decoder.layers.51': 2,
    'model.decoder.layers.52': 2,
    'model.decoder.layers.53': 2,
    'model.decoder.layers.54': 2,
    'model.decoder.layers.55': 2,
    'model.decoder.layers.56': 2,
    'model.decoder.layers.57': 2,
    'model.decoder.layers.58': 2,
    'model.decoder.layers.59': 2,
    'model.decoder.layers.60': 2,
    'model.decoder.layers.61': 2,
    'model.decoder.layers.62': 2,
    'model.decoder.layers.63': 0
}


OPT_175B_DEVICE_MAP = {
    'model.decoder.embed_tokens': 0,
    'lm_head': 0,
    'model.decoder.embed_positions': 0,
    'model.decoder.final_layer_norm': 0,
    'model.decoder.layers.0': 0,
    'model.decoder.layers.1': 0,
    'model.decoder.layers.2': 0,
    'model.decoder.layers.3': 0,
    'model.decoder.layers.4': 0,
    'model.decoder.layers.5': 0,
    'model.decoder.layers.6': 0,
    'model.decoder.layers.7': 0,
    'model.decoder.layers.8': 0,
    'model.decoder.layers.9': 0,
    'model.decoder.layers.10': 0,
    'model.decoder.layers.11': 0,
    'model.decoder.layers.12': 0,
    'model.decoder.layers.13': 0,
    'model.decoder.layers.14': 0,
    'model.decoder.layers.15': 0,
    'model.decoder.layers.16': 0,
    'model.decoder.layers.17': 0,
    'model.decoder.layers.18': 0,
    'model.decoder.layers.19': 0,
    'model.decoder.layers.20': 0,
    'model.decoder.layers.21': 0,
    'model.decoder.layers.22': 0,
    'model.decoder.layers.23': 0,
    'model.decoder.layers.24': 0,
    'model.decoder.layers.25': 1,
    'model.decoder.layers.26': 1,
    'model.decoder.layers.27': 1,
    'model.decoder.layers.28': 1,
    'model.decoder.layers.29': 1,
    'model.decoder.layers.30': 1,
    'model.decoder.layers.31': 1,
    'model.decoder.layers.32': 1,
    'model.decoder.layers.33': 1,
    'model.decoder.layers.34': 1,
    'model.decoder.layers.35': 1,
    'model.decoder.layers.36': 1,
    'model.decoder.layers.37': 1,
    'model.decoder.layers.38': 1,
    'model.decoder.layers.39': 1,
    'model.decoder.layers.40': 1,
    'model.decoder.layers.41': 1,
    'model.decoder.layers.42': 1,
    'model.decoder.layers.43': 1,
    'model.decoder.layers.44': 1,
    'model.decoder.layers.45': 1,
    'model.decoder.layers.46': 1,
    'model.decoder.layers.47': 1,
    'model.decoder.layers.48': 1,
    'model.decoder.layers.49': 2,
    'model.decoder.layers.50': 2,
    'model.decoder.layers.51': 2,
    'model.decoder.layers.52': 2,
    'model.decoder.layers.53': 2,
    'model.decoder.layers.54': 2,
    'model.decoder.layers.55': 2,
    'model.decoder.layers.56': 2,
    'model.decoder.layers.57': 2,
    'model.decoder.layers.58': 2,
    'model.decoder.layers.59': 2,
    'model.decoder.layers.60': 2,
    'model.decoder.layers.61': 2,
    'model.decoder.layers.62': 2,
    'model.decoder.layers.63': 2,
    'model.decoder.layers.64': 2,
    'model.decoder.layers.65': 2,
    'model.decoder.layers.66': 2,
    'model.decoder.layers.67': 2,
    'model.decoder.layers.68': 2,
    'model.decoder.layers.69': 2,
    'model.decoder.layers.70': 2,
    'model.decoder.layers.71': 2,
    'model.decoder.layers.72': 2,
    'model.decoder.layers.73': 3,
    'model.decoder.layers.74': 3,
    'model.decoder.layers.75': 3,
    'model.decoder.layers.76': 3,
    'model.decoder.layers.77': 3,
    'model.decoder.layers.78': 3,
    'model.decoder.layers.79': 3,
    'model.decoder.layers.80': 3,
    'model.decoder.layers.81': 3,
    'model.decoder.layers.82': 3,
    'model.decoder.layers.83': 3,
    'model.decoder.layers.84': 3,
    'model.decoder.layers.85': 3,
    'model.decoder.layers.86': 3,
    'model.decoder.layers.87': 0,
    'model.decoder.layers.88': 0,
    'model.decoder.layers.89': 0,
    'model.decoder.layers.90': 0,
    'model.decoder.layers.91': 0,
    'model.decoder.layers.92': 0,
    'model.decoder.layers.93': 0,
    'model.decoder.layers.94': 0,
    'model.decoder.layers.95': 0
}

